<HTML>
<HEAD><META name="HTML-Generator" content="Dymola"><TITLE>Modelica</TITLE></HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Examples<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Modelica.Blocks.Examples"></A><A HREF="Modelica_Blocks.html#Modelica.Blocks"
>Modelica.Blocks</A>.Examples</H2>
<B>Demonstration examples of the components of this package</B>
<P>
<A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples.BusUsage"
><IMG SRC="Modelica.Blocks.Examples.BusUsageI.png" ALT="Modelica.Blocks.Examples.BusUsage" WIDTH=80  HEIGHT=80 ></A>
<P><P>
<H3>Information</H3>
<PRE></pre>
<p>
This package contains currently one example model to demonstrate the usage of the
signal bus concept provided by the Modelica.Blocks package.
</p>

<p><b>Copyright &copy; 2002, Modelica Association and DLR.</b></p>

<p><i>
The Modelica package is <b>free</b> software; it can be redistributed and/or modified
under the terms of the <b>Modelica license</b>, see the license conditions
and the accompanying <b>disclaimer</b> in the documentation of package
Modelica in file "Modelica/package.mo".
</i></p>
<pre>
</PRE><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples.BusUsage"
>BusUsage</A>
</TD><TD>Demonstration of signal bus usage</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BusUsage<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Blocks.Examples.BusUsageI.png" ALT="Modelica.Blocks.Examples.BusUsage" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Blocks.Examples.BusUsage"></A><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples"
>Modelica.Blocks.Examples</A>.BusUsage</H2>
<B>Demonstration of signal bus usage</B><p>
<IMG SRC="Modelica.Blocks.Examples.BusUsageD.png" ALT="Modelica.Blocks.Examples.BusUsage">
<H3>Information</H3>
<PRE></pre>
<p><b>Signal bus concept</b></p>

<p>
In technical systems, such as vehicles, robots or satellites, many signals
are exchanged between components. In a simulation system, these signals 
are  usually modelled by signal connections of input/output blocks.
Unfortunately, the signal connection structure may become very complicated,
especially for hierarchical models.
</p>

<p>
The same is also true for real technical systems. To reduce complexity
and get higher flexibility, many technical systems use data buses to 
exchange data between components. For the same reasons, it is often better
to use a "signal bus" concept also in a Modelica model. This is demonstrated
at hand of this model (Modelica.Blocks.Examples.BusUsage), see diagram layer:
</p>

<ul>
<li>The thick line in the middle called "bus" is just a connector instance
    which is drawn such that it looks like a "usual" bus representation. </li>
<li>A component, such as "part", can be directly connected to the "bus", 
    provided it has also a bus connector, or the "part" connector is a 
    sub-connector contained in the "bus". </li>
</ul>

<p>
Difficulties arise if the input or output connector of an 
input/output block shall be connected directly to a variable 
of a bus because connections can only be performed between 
connectors but not between variables. For convenience, 
single variable connectors for Real, Integer and Boolean 
variables are provided as Modelica.Blocks.Interfaces.<b>RealPort</b>, 
Modelica.Blocks.Interfaces.<b>IntegerPort</b>, 
Modelica.Blocks.Interfaces.<b>BooleanPort</b>.
For example, the RealPort connector is basically defined as:
</p>
<pre>  <b>connector</b> RealPort = Real;
</pre>

<p>
This allows a definition of a bus in the form:
</p>

<pre>   <b>connector</b> Bus
      RealPort r1;
      RealPort r2;
        ...
   <b>end</b> Bus;
</pre>

<p>
and a connection to r1 and r2 is possible since these are connectors. 
Unfortunately, signals defined in this way have, by default, no unit. 
To improve this situation, a RealPort is actually defined as
</p>

<pre>   <b>connector</b> RealPort 
      <b>replaceable type</b> SignalType = Real;
      <b>extends</b> SignalType;
   <b>end</b> RealPort;
</pre>

<p>
This allows a redeclaration of the Real type to the desired type, such as:
</p>

<pre>   <b>connector</b> Bus
      <b>import</b> SI=Modelica.SIunits;
      RealPort v(<b>redeclare</b> SignalType=SI.Velocity);
      RealPort p(<b>redeclare</b> SignalType=SI.Pressure);
      ...
   <b>end</b> Bus;
</pre>

<p>
In order to connect from a RealPort connector to an InPort or OutPort 
connector of a block from the Modelica.Blocks package, an adaptor block 
is needed, since the two connectors are not compatible. Appropriate adaptors 
are provided in Modelica.Blocks.Interfaces.<b>BusAdaptors</b>. The usage can 
be seen in the diagram layer of the model at hand
(Modelica.Blocks.Examples.BusUsage). 
</p>

<p>
If a bus connector contains many signals it is no longer so easy 
to test just one part of a system, because all parts of 
the bus connector must get a value. To simplify this, 
it is practical to provide a <b>RestBus</b> component which 
sets all parts of a bus to a default value when selected 
via the parameter menu. This is also demonstrated in the example 
model (see diagram layer).
</p>

<p>Simulate the system for 1 s. The outputs of the 'receive' signal
blocks should be the same as the inputs of the 'send' signal blocks.
</p>
<pre></PRE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">encapsulated </font><font color="blue">model</font> BusUsage <font color="darkgreen">&quot;Demonstration of signal bus usage&quot;</font> 
  <font color="blue">import </font><A HREF="Modelica_Icons.html#Modelica.Icons"
>Modelica.Icons</A>;
  <font color="blue">import </font><A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors"
>Modelica.Blocks.Interfaces.BusAdaptors</A>;
  <font color="blue">import </font><A HREF="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources"
>Modelica.Blocks.Sources</A>;
  
  <font color="blue">extends </font><A HREF="Modelica_Icons.html#Modelica.Icons.Example"
>Icons.Example</A>;
  
<font color="blue">protected </font>
  <A HREF="Modelica_Blocks_Examples_Interfaces.html#Modelica.Blocks.Examples.BusUsage.Interfaces.Bus"
>Interfaces.Bus</A> bus;
<font color="blue">public </font>
  <A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors.SendReal"
>BusAdaptors.SendReal</A> putRealSignal1;
  <A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors.SendBoolean"
>BusAdaptors.SendBoolean</A> putBooleanSignal;
  <A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors.SendInteger"
>BusAdaptors.SendInteger</A> putIntegerSignal;
  <A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors.ReceiveReal"
>BusAdaptors.ReceiveReal</A> getRealSignal1;
  <A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors.ReceiveBoolean"
>BusAdaptors.ReceiveBoolean</A> getBooleanSignal;
  <A HREF="Modelica_Blocks_Interfaces_BusAdaptors.html#Modelica.Blocks.Interfaces.BusAdaptors.ReceiveInteger"
>BusAdaptors.ReceiveInteger</A> getIntegerSignal;
  <A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples.BusUsage.RestBus"
>RestBus</A> restBus(
                  set_realSignal2=true);
  <A HREF="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.IntegerStep"
>Sources.IntegerStep</A> generateIntegerSignal(
    height={1},
    offset={2},
    startTime={0.5});
  <A HREF="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.BooleanStep"
>Sources.BooleanStep</A> generateBooleanSignal(
                                            startTime={0.5});
  <A HREF="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Sine"
>Sources.Sine</A> generateRealSignal1;
  
  <font color="blue">encapsulated </font><font color="blue">package</font> Interfaces <font color="darkgreen">
    &quot;Interfaces specialised for this example&quot;</font> 
    
    <font color="blue">connector</font> MultiPort <font color="darkgreen">&quot;Combined port of real and boolean signal&quot;</font> 
      Real myRealSignal;
      Boolean myBooleanSignal;
      
    <font color="blue">end </font>MultiPort;
    
    <font color="blue">connector</font> Bus <font color="darkgreen">&quot;Signal bus&quot;</font> 
      <font color="blue">import </font>SI = <A HREF="Modelica_SIunits.html#Modelica.SIunits"
>Modelica.SIunits</A>;
      <font color="blue">import </font><A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces"
>Modelica.Blocks.Interfaces</A>.*;
      
      <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealPort"
>RealPort</A> realSignal1( <font color="blue">redeclare </font><font color="blue">type</font> SignalType = <A HREF="Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>SI.AngularVelocity</A>) <font color="darkgreen">&quot;First Real signal (angular velocity)&quot;</font>;
      <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealPort"
>RealPort</A> realSignal2 <font color="darkgreen">&quot;Second Real signal&quot;</font>;
      <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerPort"
>IntegerPort</A> integerSignal <font color="darkgreen">&quot;Integer signal&quot;</font>;
      <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BooleanPort"
>BooleanPort</A> booleanSignal <font color="darkgreen">&quot;Boolean signal&quot;</font>;
      <A HREF="Modelica_Blocks_Examples_Interfaces.html#Modelica.Blocks.Examples.BusUsage.Interfaces.MultiPort"
>MultiPort</A> multiSignal <font color="darkgreen">&quot;Combined signal&quot;</font>;
      
    <font color="blue">end </font>Bus;
  <font color="blue">end </font>Interfaces;
  
  <font color="blue">encapsulated </font><font color="blue">model</font> Part <font color="darkgreen">&quot;Component with MultiPort connector&quot;</font> 
    <font color="blue">import </font><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples"
>Modelica.Blocks.Examples</A>;
    
    <A HREF="Modelica_Blocks_Examples_Interfaces.html#Modelica.Blocks.Examples.BusUsage.Interfaces.MultiPort"
>Examples.BusUsage.Interfaces.MultiPort</A> multiSignal;
    
  <font color="blue">equation </font>
    multiSignal.myRealSignal = time;
    multiSignal.myBooleanSignal = time &gt; 0.5;
  <font color="blue">end </font>Part;
  
  <font color="blue">encapsulated </font><font color="blue">model</font> RestBus <font color="darkgreen">
    &quot;Set default values for bus variables that are not defined elsewhere&quot;</font> 
    
    <font color="blue">import </font><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples"
>Modelica.Blocks.Examples</A>;
    
    <font color="blue">parameter </font>Boolean set_realSignal1=false <font color="darkgreen">
      &quot;Set dummy value for desiredThrottle&quot;</font>;
    <font color="blue">parameter </font>Boolean set_realSignal2=false <font color="darkgreen">&quot;Set dummy value for brake&quot;</font>;
    <font color="blue">parameter </font>Boolean set_integerSignal=false <font color="darkgreen">
      &quot;Set dummy value for controlLeverPosition&quot;</font>;
    <font color="blue">parameter </font>Boolean set_booleanSignal=false <font color="darkgreen">&quot;Set dummy value for desiredGear&quot;</font>;
    <font color="blue">parameter </font>Boolean set_multiSignal=false <font color="darkgreen">&quot;Set dummy value for ignition&quot;</font>;
    
    <A HREF="Modelica_Blocks_Examples_Interfaces.html#Modelica.Blocks.Examples.BusUsage.Interfaces.Bus"
>Examples.BusUsage.Interfaces.Bus</A> bus;
  <font color="blue">equation </font>
    <font color="blue">if </font>set_realSignal1<font color="blue"> then</font>
      bus.realSignal1 = 0;
    <font color="blue">end if</font>;
    <font color="blue">if </font>set_realSignal2<font color="blue"> then</font>
      bus.realSignal2 = 0;
    <font color="blue">end if</font>;
    <font color="blue">if </font>set_integerSignal<font color="blue"> then</font>
      bus.integerSignal = 0;
    <font color="blue">end if</font>;
    <font color="blue">if </font>set_booleanSignal<font color="blue"> then</font>
      bus.booleanSignal = false;
    <font color="blue">end if</font>;
    <font color="blue">if </font>set_multiSignal<font color="blue"> then</font>
      bus.multiSignal.myRealSignal = 0;
      bus.multiSignal.myBooleanSignal = false;
    <font color="blue">end if</font>;
  <font color="blue">end </font>RestBus;
  
  <A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples.BusUsage.Part"
>Part</A> part;
<font color="blue">equation </font>
  
  <font color="red">connect</font>(putRealSignal1.toBus, bus.realSignal1);
  <font color="red">connect</font>(putIntegerSignal.toBus, bus.integerSignal);
  <font color="red">connect</font>(generateRealSignal1.outPort, putRealSignal1.inPort);
  <font color="red">connect</font>(generateBooleanSignal.outPort, putBooleanSignal.inPort);
  <font color="red">connect</font>(generateIntegerSignal.outPort, putIntegerSignal.inPort);
  <font color="red">connect</font>(getRealSignal1.fromBus, bus.realSignal1);
  <font color="red">connect</font>(getIntegerSignal.fromBus, bus.integerSignal);
  <font color="red">connect</font>(restBus.bus, bus);
  <font color="red">connect</font>(putBooleanSignal.toBus, bus.booleanSignal);
  <font color="red">connect</font>(getBooleanSignal.fromBus, bus.booleanSignal);
  <font color="red">connect</font>(part.multiSignal, bus.multiSignal);
<font color="blue">end </font>BusUsage;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE RestBus<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Blocks.Examples.BusUsage.RestBusI.png" ALT="Modelica.Blocks.Examples.BusUsage.RestBus" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Blocks.Examples.BusUsage.RestBus"></A><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples.BusUsage"
>Modelica.Blocks.Examples.BusUsage</A>.RestBus</H2>
<B>Set default values for bus variables that are not defined elsewhere</B><p>
<IMG SRC="Modelica.Blocks.Examples.BusUsage.RestBusD.png" ALT="Modelica.Blocks.Examples.BusUsage.RestBus">
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>set_realSignal1</TD><TD>false</TD><TD>Set dummy value for desiredThrottle</TD></TR>
<TR><TD>set_realSignal2</TD><TD>false</TD><TD>Set dummy value for brake</TD></TR>
<TR><TD>set_integerSignal</TD><TD>false</TD><TD>Set dummy value for controlLeverPosition</TD></TR>
<TR><TD>set_booleanSignal</TD><TD>false</TD><TD>Set dummy value for desiredGear</TD></TR>
<TR><TD>set_multiSignal</TD><TD>false</TD><TD>Set dummy value for ignition</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">encapsulated </font><font color="blue">model</font> RestBus <font color="darkgreen">
  &quot;Set default values for bus variables that are not defined elsewhere&quot;</font> 
  
  <font color="blue">import </font><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples"
>Modelica.Blocks.Examples</A>;
  
  <font color="blue">parameter </font>Boolean set_realSignal1=false <font color="darkgreen">&quot;Set dummy value for desiredThrottle&quot;</font>;
  <font color="blue">parameter </font>Boolean set_realSignal2=false <font color="darkgreen">&quot;Set dummy value for brake&quot;</font>;
  <font color="blue">parameter </font>Boolean set_integerSignal=false <font color="darkgreen">
    &quot;Set dummy value for controlLeverPosition&quot;</font>;
  <font color="blue">parameter </font>Boolean set_booleanSignal=false <font color="darkgreen">&quot;Set dummy value for desiredGear&quot;</font>;
  <font color="blue">parameter </font>Boolean set_multiSignal=false <font color="darkgreen">&quot;Set dummy value for ignition&quot;</font>;
  
  <A HREF="Modelica_Blocks_Examples_Interfaces.html#Modelica.Blocks.Examples.BusUsage.Interfaces.Bus"
>Examples.BusUsage.Interfaces.Bus</A> bus;
<font color="blue">equation </font>
  <font color="blue">if </font>set_realSignal1<font color="blue"> then</font>
    bus.realSignal1 = 0;
  <font color="blue">end if</font>;
  <font color="blue">if </font>set_realSignal2<font color="blue"> then</font>
    bus.realSignal2 = 0;
  <font color="blue">end if</font>;
  <font color="blue">if </font>set_integerSignal<font color="blue"> then</font>
    bus.integerSignal = 0;
  <font color="blue">end if</font>;
  <font color="blue">if </font>set_booleanSignal<font color="blue"> then</font>
    bus.booleanSignal = false;
  <font color="blue">end if</font>;
  <font color="blue">if </font>set_multiSignal<font color="blue"> then</font>
    bus.multiSignal.myRealSignal = 0;
    bus.multiSignal.myBooleanSignal = false;
  <font color="blue">end if</font>;
<font color="blue">end </font>RestBus;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Part<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Blocks.Examples.BusUsage.PartI.png" ALT="Modelica.Blocks.Examples.BusUsage.Part" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Blocks.Examples.BusUsage.Part"></A><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples.BusUsage"
>Modelica.Blocks.Examples.BusUsage</A>.Part</H2>
<B>Component with MultiPort connector</B><p>
<IMG SRC="Modelica.Blocks.Examples.BusUsage.PartD.png" ALT="Modelica.Blocks.Examples.BusUsage.Part">
<H3>Modelica definition</H3>
<PRE>
<font color="blue">encapsulated </font><font color="blue">model</font> Part <font color="darkgreen">&quot;Component with MultiPort connector&quot;</font> 
  <font color="blue">import </font><A HREF="Modelica_Blocks_Examples.html#Modelica.Blocks.Examples"
>Modelica.Blocks.Examples</A>;
  
  <A HREF="Modelica_Blocks_Examples_Interfaces.html#Modelica.Blocks.Examples.BusUsage.Interfaces.MultiPort"
>Examples.BusUsage.Interfaces.MultiPort</A> multiSignal;
  
<font color="blue">equation </font>
  multiSignal.myRealSignal = time;
  multiSignal.myBooleanSignal = time &gt; 0.5;
<font color="blue">end </font>Part;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Wed Jun 30 17:42:54 2004
.
</address></BODY>
</HTML>
